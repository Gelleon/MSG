# Техническое задание (ТЗ)  
## Проект: Web-мессенджер для управления проектами

---

## 1. Общее описание проекта

Необходимо разработать **web-мессенджер проектов** с интерфейсом, логикой и UX, аналогичными **веб-версии Telegram**, с адаптацией под мобильные устройства.

Цель системы:
- коммуникация внутри проектов;
- разграничение прав доступа по ролям;
- групповые и приватные чаты;
- обмен файлами;
- автоматический перевод сообщений между китайским и русским языками с использованием ChatGPT API.

---

## 2. Платформа и доступ

- Тип приложения: **Web Application**
- Поддержка браузеров: Chrome, Safari, Firefox, Edge (актуальные версии)
- Адаптация под мобильные устройства (responsive design)
- Мобильное приложение не требуется

---

## 3. Авторизация и учетные записи

### 3.1 Окно авторизации
Функциональность:
- вход по email + пароль;
- регистрация пользователя;
- восстановление пароля (опционально, закладывается архитектурно).

### 3.2 Создание учетных записей
- **Владелец проекта** может:
  - создавать проекты;
  - создавать учетные записи пользователей;
  - назначать роли.
- Остальные роли не могут создавать учетные записи.

---

## 4. Роли и модель доступа

### 4.1 Роли в системе
- Владелец
- Админ
- Менеджер
- Клиент
- Партнер

> Права для ролей Админ, Менеджер, Клиент, Партнер будут уточнены позже.  
> Необходимо заложить гибкую **RBAC-модель (Role Based Access Control)**.

### 4.2 Минимальные права (на текущем этапе)

| Действие | Владелец | Админ | Менеджер | Партнер | Клиент |
|--------|----------|-------|----------|---------|--------|
| Вход в систему | ✅ | ✅ | ✅ | ✅ | ✅ |
| Просмотр комнат | ✅ | ✅ | ✅ | ✅ | ✅ |
| Участие в чатах | ✅ | ✅ | ✅ | ✅ | ✅ |
| Приватное общение | ✅ | ✅ | ✅ | ✅ | ❌ |

---

## 5. Интерфейс мессенджера

### 5.1 Общая структура (как Telegram Web)

После входа пользователь попадает в основной интерфейс:

- экран разделен на **2 части**:
  - **левая панель** — список комнат и приватных чатов;
  - **правая панель** — активный чат.

---

## 6. Комнаты (групповые чаты)

### 6.1 Управление комнатами
- **Админ** и **Владелец** могут:
  - создавать комнаты;
  - задавать название комнаты;
  - управлять участниками.

### 6.2 Возможности комнаты
- текстовый чат;
- передача файлов:
  - документы;
  - изображения;
  - другие типы файлов (ограничения определяются позже);
- хранение истории сообщений.

---

## 7. Приглашение участников в комнату

### 7.1 Генерация ссылки-приглашения
- **Админ** и **Владелец** могут генерировать ссылку приглашения.
- Перед генерацией ссылки необходимо выбрать роль, которая будет назначена пользователю:
  - Менеджер
  - Клиент
  - Партнер

### 7.2 Поведение ссылки
- ссылка должна быть одноразовой;
- при переходе по ссылке:
  - пользователь авторизуется или регистрируется;
  - автоматически добавляется в комнату с указанной ролью.

---

## 8. Приватное общение внутри комнаты

### 8.1 Общие правила
- Приватное общение доступно ролям:
  - Владелец;
  - Админ;
  - Менеджер;
  - Партнер.
- Клиент не имеет доступа к приватному общению.

---

### 8.2 Логика приватного общения

1. В комнате ведется общий чат — все участники видят сообщения.
2. Участник с правами приватного общения нажимает кнопку **«Приватное общение»**.
3. Открывается модальное окно:
   - список участников комнаты;
   - выбор участников для приватного общения.
4. После подтверждения:
   - сообщения помечаются как приватные;
   - их видят только выбранные участники.
5. Участники, не приглашенные в приватное общение:
   - не видят приватные сообщения;
   - могут продолжать общение в общем чате.
6. После завершения приватного общения:
   - чат возвращается в обычный режим.

---

### 8.3 Ограничения
- Приватное общение возможно только между приглашенными участниками.
- Клиент:
  - не видит кнопку приватного общения;
  - не может быть приглашен в приватное общение.

---

## 9. Международное общение и перевод сообщений

### 9.1 Поддерживаемые языки
- Русский
- Китайский

### 9.2 Логика перевода
- сообщение на китайском языке автоматически переводится на русский;
- сообщение на русском языке автоматически переводится на китайский;
- перевод осуществляется с использованием **ChatGPT API**;
- в интерфейсе отображается:
  - оригинальный текст;
  - перевод (под оригиналом или по переключателю).

---

## 10. Архитектурные требования

### 10.1 Рекомендуемый стек (может быть изменен)

**Frontend**
- React / Next.js
- TypeScript
- TailwindCSS или аналог
- WebSocket (Socket.io или native WS)

**Backend**
- Node.js (NestJS / Express)
- REST + WebSocket
- JWT авторизация
- RBAC система ролей

**Database**
- PostgreSQL или MongoDB

### 10.2 Основные сущности
- User
- Role
- Project
- Room
- Message
- PrivateSession
- InvitationLink
- File

---

## 11. Безопасность и ограничения

- проверка прав доступа на:
  - отправку сообщений;
  - создание комнат;
  - генерацию приглашений;
  - приватное общение;
- приватные сообщения изолированы на уровне backend;
- клиент не должен иметь технической возможности получить приватные сообщения через API.

---

## 12. Статус документа

- документ является **черновым**;
- предполагается расширение ролей и прав;
- архитектура должна быть гибкой и масштабируемой.

---
